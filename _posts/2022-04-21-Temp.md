---
layout: post
mathjax: true
title: The MOV attack on Elliptic Curve Cryptography
category: uc

---

{% include mathjax.html %}

# Why Elliptic Curve Cryptography?  

**Q.** Why does modern cryptography prefer the discrete log problem on the group of points on an Elliptic Curve defined over a Finite Field rather than integer factorization or the discrete log problem over the multiplicative group of a Finite Field?

**A.** A cryptographic algorithm is said to have a security level of $n$ bits if the best known attack can break it in $2^n$ steps. So if the naive brute force/exhaustive search is the best known attack for any algorithm the security level will be same as the key size in bits. However most asymmetric algorithms have much better attacks than the naive attack & hence their security level is lesser than the size. For e.g. the Discrete Log problme on which Diffie Hellman is based on has a very powerful attack called as Index Calculus. To compensate for this attack, we have to use very large key sizes in DH. To get 112 bit security DH needs 2048 bit key size. This is because of a very powerful attack known as Index Calculus which can attack the Discrete Log problem in sub-exponential time. The Index Calculus method uses smooth numbers. Likeiwise, the General Number Field Sieve for Integer Factorzation using Smooth numbers means RSA also requires a 2048 bit key size to get 112 bit security.

Unlike the multiplicative group of a Finite Field, the group of Elliptic Curve points doesn't have a straightforward notion of smoothness & any methods similiar to Index Calculus hasn't been discovered in this group. Hence in Elliptic Curve Cryptography you can get 112 bit security with a 224 bit Key Size.

$$
\begin{array}{c|c}
 {\text{Algorithm}} & {\text{Size}} \\\hline
 RSA & 2048 \\\hline
 DH & 2048 \\\hline
 ECDH & 224 \\\hline
\end{array}
$$

*Note:* For asymmetric algorithms like the above, key size typically refers to the size of the modulus.

So one can use an elliptic curve group that is smaller in size while maintaining the same level of security. In many situations, the result is smaller key sizes, bandwidth savings and faster operations. 

## The MOV attack

MOV (Menezes-Okamoto-Vanstone) attack transforms a Discrete Log problem in an Elliptic Curve Group into a Discrete Log Problem in a Finite Field - i.e. DLP to ECDLP. Since Index Calclus is possible in DLP, it becomes easier to break it & use it to solve the ECDLP.

*Some background first*

### What is a bilinear map?

We can look at linear & bilinear maps using the example of Vector Spaces.

Let 

- $U, V, W$ be vector spaces 
- $\lbrace u, u_1, u_2  \in U \rbrace$ , $\lbrace v, v_1, v_2 \in V \rbrace$ 
- $\alpha$ is a scalar
- $f_1 : V \mapsto W \space (f_1$ is a map from $V$ to $W$)
- $f_2 : U$ X $V \mapsto W \space (f_2$ is a map from $U$ X $V$ to $W)\\\\$

$f_1$ is a **linear map** if   

- $f_1(v_1, v_2) = f_1(v_1) + f_1(v_2)$   

- $f_1(\alpha v) = \alpha f_1(v)\\\\$ 


$f_2$ is a **bilinear map** if 

- $f_2(u_1 + u_2, v) = f_2(u_1, v) + f_2(u_2, v)$

- $f_2(u, v_1 + v_2) = f_2(u, v_1) + f_2(u, v_2)$  

- $f_2(\alpha u, v) = \alpha f_2(u, v) = f_2(u, \alpha v)$

This means that the map is linear in $u$ if $v$ is fixed & is linear in $v$ if $u$ is fixed.

A bilinear map is **non-degenerate** if & only if  

- $f_2(u, v) = 0$ for all $v \in V$ implies that $u = 0$

### Roots of Unity

For $t^n = 1$, $\sqrt[n]t$ are the $n$ $n$th roots of unity.
For e.g. for $t=2$, the $2$ $2$nd roots of unity are $\lbrace 1, -1 \rbrace$

With $n$ more than $2$, all the roots aren't in $\mathbb R$ but in $\mathbb C$. 
It can be easily found using the polar form of complex numbers.

In polar form, any complex number is represented as $r.e^{i\theta}$ & $e^{i\theta} = cos(\theta) + i.sin(\theta)$

$t = r.e^{i\theta}$ where $t \in \mathbb C$

$t^n = {r^n.e^{i\theta}}^n = 1$

$r^n.e^{ni\theta} = 1.e^{i0}$

Equating $r^n = 1$, we get $r = 1$ (why can't r be one of the other roots?)

$e^{ni\theta} = 1$

Using Euler's formula $e^{i\theta} = cos(\theta) + i sin(\theta)}

$cos(n\theta) + i sin(n\theta) = 1 + i0$

Equating the real parts,

$cos(n\theta) = 1$

But $cos(x)$ is $1$ only for these values $\lbrace \dots, -4\pi, -2\pi, 0, 2\pi, 4\pi, \dots \rbrace$, i.e. the multiples of $2\pi$
 
So, $n\theta = 2k\pi$ with $k \in \mathbb Z$

$\theta = \frac {2k\pi}{n}$

Though $k \in \mathbb Z$, the values of $cos$ start repeating, so we can just consider $k = \lbrace 0, 1, 2, \dots, n-1 \rbrace$


So $\sqrt[n]1 = e^{i\frac{2k\pi}{n}}$ with $k = \lbrace 0,\dots, n-1 \rbrace$ - the $n\space n$th roots of unity

The $3$ $3$rd roots are $\lbrace e^{i0}, e^{i120}, e^{i240} \rbrace$
The $4$ $4$th roots are $\lbrace e^{i0}, e^{i90}, e^{i180}, e^{i270} \rbrace$ and so on.

In each of these cases, the root we get with $k=1$ is called the primitive root because it can generate all the other roots.

### Embedding Degree

$E$ be an elliptic curve defined over a prime field $(\mathbb F_q)$. $P$ is a point on $E(\mathbb F_q)$ of order $n$ where $n$ is prime & is also coprime with $q$.
$k$ is the smallest positive integer such that 

$q^k \equiv 1 \bmod n$

Then $k$ is called as the embedding degree of the curve $E(\mathbb F_q)$

### The Weil Pairing 

From $q^k \equiv 1 \bmod n$, we get 

$q^k = nx + 1$ 

$q^k – 1 = nx$

so $n$ divides $q^k – 1$

Consider the extension field $\mathbb F_{q^k}$. The multiplicative group of $F_q^k$ is ${F^*}_{q^k}$ whose order 
